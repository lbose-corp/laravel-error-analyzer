# Clean Code PHP Principles Reference

参照元: `https://github.com/piotrplenik/clean-code-php`

この資料は `piotrplenik/clean-code-php` の構成を、実装レビューで使いやすい形に要約したチェックリストである。  
原文の「絶対ルール化」ではなく、プロダクト制約と互換性を前提に優先順位をつけて適用する。

## 1. Variables

- 意図が分かる名前を使う（略語を避ける）。
- 同じ概念は同じ語彙を使う。
- 真偽値には `is` / `has` / `can` など意味が伝わる接頭辞を使う。
- マジックナンバーを定数化する。
- 不要な中間変数を増やさない。

## 2. Functions

- 1 関数 1 責務を守る。
- 引数を増やしすぎない。3 以上になる場合は DTO/Value Object を検討する。
- フラグ引数で分岐させない。処理を分割する。
- 副作用を分離し、可能な範囲で純粋関数を使う。
- 早期 return でネストを浅くする。

## 3. Objects and Data Structures

- 継承より合成を優先する。
- クラスの公開 API を最小化する。
- 不変にできる値は不変にする。
- Data Transfer Object と振る舞いを持つオブジェクトを混在させない。
- Law of Demeter を意識し、深いチェーン呼び出しを減らす。

## 4. Classes

- SRP（単一責務）を最優先で守る。
- クラスが肥大化したらユースケース単位で分割する。
- static メソッドの乱用を避け、依存は注入する。
- 例外の境界を明示し、握り潰さない。

## 5. SOLID

- SRP: 変更理由が複数あるクラスを分割する。
- OCP: 既存実装の if/switch 追加より拡張点（interface）を検討する。
- LSP: 置換可能性を壊す継承を避ける。
- ISP: 利用者ごとに必要最小の interface を定義する。
- DIP: 具体クラスではなく抽象へ依存させる。

## 6. DRY

- コピペの前に意味的重複かを確認する。
- 早すぎる共通化を避ける（3 回出現ルールなどで判断する）。
- 共通化後に可読性が落ちるなら重複維持を許容する。

## 7. Error Handling and Boundaries

- Fail Fast を徹底する。
- 例外はコンテキストを補足して再送出する。
- `null` を返す設計は境界で吸収し、内部では型を明確にする。
- 外部 I/O（DB, HTTP, Queue）は境界層に隔離する。

## 8. Review Output Template

レビュー結果は次の順で提示する。

1. 対象ファイル
2. 観測した問題（原則名つき）
3. 最小修正案
4. 影響範囲
5. 検証方法（静的解析・テスト）

